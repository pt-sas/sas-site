function reloadTable(){_table.ajax.reload(null,!1)}function Edit(e){let t,a;if(ID=e,cardMain.length>0)if(cardMain.css("display","none"),cardForm.css("display","block"),cardForm.prop("classList").contains("modal"))cardMain.css("display","block"),cardForm.css("display","none"),a=cardForm.prop("classList"),t=cardForm.find("form");else{cardBtn.css("display","block");const e=cardForm.closest(".card"),o=e.find(".card-header").find("button");$.each(o,function(){const e=this.classList;e.contains("new_form")&&$(this).hide()}),a=cardForm.prop("classList"),t=cardForm.find("form")}else openModalForm(),Scrollmodal(),t=modalForm.find("form"),a=cardForm.prop("classList");const o=t.find("input, textarea, select");let n=SITE_URL+SHOW+ID;setSave="update",$.ajax({url:n,type:"GET",cache:!1,dataType:"JSON",beforeSend:function(){$(".save_form").attr("disabled",!0),$(".x_form").attr("disabled",!0),$(".close_form").attr("disabled",!0),loadingForm(t.prop("id"),"facebook")},complete:function(){$(".save_form").removeAttr("disabled"),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled"),hideLoadingForm(t.prop("id"))},success:function(e){for(let n=0;n<e.length;n++){let i=e[n].field,r=e[n].label;a.contains("modal")&&"title"===i?modalTitle.html(capitalize(r)):"title"===i&&cardTitle.html(capitalize(r));for(let e=0;e<o.length;e++)if(o[e].name===i){let a=o[e].className.split(/\s+/);t.find("input:text[name="+o[e].name+"], textarea[name="+o[e].name+"]").val(r),t.find("select[name="+o[e].name+"]").val(r).change(),"checkbox"===o[e].type&&"Y"===r?(t.find("input:checkbox[name="+o[e].name+"]").prop("checked",!0),a.includes("active")&&readonly(t,!1)):(t.find("input:checkbox[name="+o[e].name+"]").removeAttr("checked"),a.includes("active")&&readonly(t,!0)),"radio"==o[e].type&&o[e].value==r&&(o[e].checked=!0),"file"===o[e].type&&null!==r?previewImage(t.find("input:file")[0],"",r):"file"===o[e].type&&null===r&&previewImage(t.find("input:file")[0],"",r)}}},error:function(e,t){showError(e,t)}})}function Destroy(e){let t=SITE_URL+DELETE+e;Swal.fire({title:"Delete?",text:"Are you sure you wish to delete the selected data ? ",type:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Okay",cancelButtonText:"Close",reverseButtons:!0}).then(e=>{e.value&&$.post(t,function(e){Swal.fire({title:"Deleted!",text:"Your data has been deleted.",type:"success",timer:1e3}),reloadTable()}).fail(function(e,t,a){console.info(a),reloadTable()})})}function arrContains(e,t){var a=null;for(let n=0;n<t.length;n++){var o=t[n];if(o.toString().toLowerCase()===e.toString().toLowerCase()){a=o;break}}return a}function errorForm(e,t){const a=e.find('input[type="text"], select, textarea'),o=e.find("small");var n=[],i=[];for(let e=0;e<o.length;e++)""!==o[e].id&&i.push(o[e].id);for(let e=0;e<a.length;e++)n.push(a[e].name);for(let a=0;a<t.length;a++){var r=t[a].error,l=t[a].field,s=t[a].label,d=arrContains(r,i),c=arrContains(l,n);""!==s?(e.find("small[id="+d+"]").html(s),e.find("input:text[name="+c+"], select[name="+c+"], textarea[name="+c+"]").parent("div").addClass("has-error")):(e.find("small[id="+d+"]").html(""),e.find("input:text[name="+c+"], select[name="+c+"], textarea[name="+c+"]").parent("div").removeClass("has-error"))}}function clearForm(e){const t=$(e.target).closest(".row"),a=t.find("form"),o=a.find("input, textarea, select"),n=a.find("small");a[0].reset();for(let e=0;e<o.length;e++){let t=$(o[e]).find("option:selected");a.find("input[name="+o[e].name+"], textarea[name="+o[e].name+"]").removeAttr("readonly").parent("div").removeClass("has-error has-feedback"),a.find("input:checkbox[name="+o[e].name+"]").removeAttr("disabled"),t.length>0&""!==t.val()?a.find("select[name="+o[e].name+"]").removeAttr("disabled").val(t.val()).change():a.find("select[name="+o[e].name+"]").removeAttr("disabled").val(null).change(),"file"===o[e].type&&$(".close-img").click()}for(let e=0;e<n.length;e++)""!==n[e].id&&a.find("small[id="+n[e].id+"]").html("")}function readonly(e,t){const a=e.find("input, textarea, select");for(let o=0;o<a.length;o++){let n=a[o].className.split(/\s+/)[1];e.find("input:text[name="+a[o].name+"], textarea[name="+a[o].name+"]").prop("readonly",t),"text"!==a[o].type&&"active"!==n&&e.find("input:checkbox[name="+a[o].name+"], select[name="+a[o].name+"], input:radio[name="+a[o].name+"]").prop("disabled",t)}}function previewImage(e,t,a){let o=e.closest("label");if(t=t||".img-result",e.files&&e.files[0]){let a=new FileReader;a.onload=function(e){loadingForm(o.id,"pulse"),$(".save_form").attr("disabled",!0),$(".x_form").attr("disabled",!0),$(".close_form").attr("disabled",!0),setTimeout(function(){$(t).attr("src",e.target.result).width("auto").height(150),$(".form-upload-foto").css("display","none"),$(".form-result").css("display","block"),hideLoadingForm(o.id),$(".save_form").removeAttr("disabled"),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled")},2500)},a.readAsDataURL(e.files[0])}else null!==a?($(t).attr("src",ORI_URL+"/"+a).width("auto").height(150),$(".form-upload-foto").css("display","none"),$(".form-result").css("display","block")):($(t).attr("src",a).width("auto").height(150),$(".form-upload-foto").css("display","block"),$(".form-result").css("display","none"))}function showError(e,t){let a="";a=0===e.status?"Not connect.\n Verify Network.":404==e.status?"Requested page not found. [404]":500==e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error.\n"+e.responseText,Toast.fire({type:"error",title:a})}function loadingForm(e,t){$("#"+e).waitMe({effect:t,text:"Please wait...",bg:"rgba(255,255,255,0.7)",color:"#000",maxSize:"",waitTime:-1,textPos:"vertical",fontSize:"100%",source:"",onClose:function(){}})}function hideLoadingForm(e){$("#"+e).waitMe("hide")}function openModalForm(){return modalForm.modal({backdrop:"static",keyboard:!1})}function Scrollmodal(){return modalDialog.addClass("modal-dialog-scrollable")}const ADMIN="/backend/";var ID,_table,setSave,ORI_URL=window.location.origin,SITE_URL=window.location.href,LAST_URL=SITE_URL.substr(SITE_URL.lastIndexOf("/")+1),ADMIN_URL=ORI_URL+ADMIN;const SHOWALL="/showAll",CREATE="/create",SHOW="/show/",EDIT="/edit",DELETE="/destroy/";let cardMain=$(".card-main"),cardForm=$(".card-form"),cardBtn=$(".card-button"),cardTitle=$(".card-title");const modalForm=$(".modal_form"),modalDialog=$(".modal-dialog"),modalTitle=$(".modal-title"),modalBody=$(".modal-body");_table=$(".tb_display").DataTable({ajax:SITE_URL+SHOWALL,processing:!0,language:{processing:'<i class="fas fa-spinner fa-spin fa-1x fa-fw"></i><span> Processing...</span>'},columnDefs:[{targets:-1,orderable:!1},{targets:0,visible:!1}],autoWidth:!0,scrollX:!0}),$(".save_form").click(function(e){const t=$(e.target).closest(".row"),a=t.find("form");cardForm=t.find(".card-form");let o,n=new FormData(a[0]);const i=a.find('input[type="checkbox"], select, input[type="radio"], input[type="file"]');for(let e=0;e<i.length;e++)a.find("input:checkbox[name="+i[e].name+"], select[name="+i[e].name+"]").removeAttr("disabled");"add"===setSave?o=SITE_URL+CREATE:(n.append("id",ID),o=SITE_URL+EDIT);for(let e=0;e<i.length;e++)if("radio"==i[e].type&&i[e].checked&&n.append(i[e].name,i[e].value),"file"==i[e].type)if(i[e].files.length>0)n.append(i[e].name,i[e].files[0]);else{let t=a.find(".img-result").attr("src"),o=t.substr(t.lastIndexOf("/")+1);n.append(i[e].name,o)}$.ajax({url:o,type:"POST",data:n,processData:!1,contentType:!1,async:!1,cache:!1,dataType:"JSON",beforeSend:function(){$(".save_form").prop("disabled",!0),$(".x_form").prop("disabled",!0),$(".close_form").prop("disabled",!0),loadingForm(a.prop("id"),"facebook")},complete:function(){$(".save_form").removeAttr("disabled"),$(".x_form").removeAttr("disabled"),$(".close_form").removeAttr("disabled"),hideLoadingForm(a.prop("id"))},success:function(o){if(o[0].success){if(Toast.fire({type:"success",title:o[0].message}),clearForm(e),cardForm.prop("classList").contains("modal"))modalForm.modal("hide");else{cardMain.css("display","block"),cardForm.css("display","none"),cardBtn.css("display","block");const e=t.find(".card-header"),a=e.find("button");$.each(a,function(){const e=this.classList;e.contains("new_form")&&$(this).show()})}cardTitle.html(capitalize(LAST_URL)),reloadTable()}else o[0].error?(errorForm(a,o),hideLoadingForm(a.prop("id"))):Toast.fire({type:"error",title:o[0].message})},error:function(e,t){showError(e,t)}});for(let e=0;e<i.length;e++){let t=i[e].className.split(/\s+/);a.find("input.active").is(":checked")?a.find("input:checkbox[name="+i[e].name+"], select[name="+i[e].name+"]").removeAttr("disabled"):t.includes("active")||a.find("input:checkbox[name="+i[e].name+"], select[name="+i[e].name+"]").prop("disabled",!0)}}),$(document).on("click",".x_form, .close_form",function(e){if("modal"!==$(e.currentTarget).attr("data-dismiss")){const t=$(e.target).closest(".row");cardMain.css("display","block"),cardForm.css("display","none"),cardBtn.css("display","none");const a=t.find(".card-header"),o=a.find("button").prop("classList");o.contains("new_form")&&a.find("button").show()}clearForm(e),cardTitle.html(capitalize(LAST_URL))}),$(".new_form").click(function(e){const t=$(e.target).closest(".row"),a=t.find(".card-main");let o;a.length>0?(cardMain.css("display","none"),cardForm.css("display","block"),cardForm.prop("classList").contains("modal")?(cardMain.css("display","block"),cardForm.css("display","none")):(cardBtn.css("display","block"),cardTitle.html("New "+capitalize(LAST_URL)),$(this).hide(),o=cardForm,o.find('input[type="checkbox"].active').prop("checked",!0))):(openModalForm(),Scrollmodal(),o=modalForm.find("form"),modalTitle.html("New1 "+capitalize(LAST_URL)),o.find('input[type="checkbox"].active').prop("checked",!0)),setSave="add"}),$("input.active:checkbox").change(function(e){const t=$(this).closest("form"),a=t.find("input, textarea, select");let o;if($(this).is(":checked"))for(let e=0;e<a.length;e++)o=a[e].className.split(/\s+/),t.find("input:text[name="+a[e].name+"], textarea[name="+a[e].name+"]").removeAttr("readonly"),"text"===a[e].type||o.includes("active")||(t.find("input:checkbox[name="+a[e].name+"], select[name="+a[e].name+"]").removeAttr("disabled"),"file"===a[e].type&&(t.find("input[name="+a[e].name+"]").removeAttr("disabled"),t.find("button.close-img").removeAttr("disabled")));else for(let e=0;e<a.length;e++)o=a[e].className.split(/\s+/),t.find("input:text[name="+a[e].name+"], textarea[name="+a[e].name+"]").prop("readonly",!0),"text"===a[e].type||o.includes("active")||(t.find("input:checkbox[name="+a[e].name+"], select[name="+a[e].name+"]").prop("disabled",!0),"file"===a[e].type&&(t.find("input[name="+a[e].name+"]").prop("disabled",!0),t.find("button.close-img").prop("disabled",!0)))}),$(".close-img").click(function(e){const t=$(e.currentTarget).closest("div"),a=t.closest(".form-group"),o=a.find(".form-upload");let n=t.find("label").prop("className");n.includes("form-result")&&(o.find("label").css("display","block"),t.find("label").css("display","none"),o.find("input:file").val(""),t.find("img").attr("src",""))});const capitalize=e=>"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1);$(document).ready(function(e){$(".select2").select2({placeholder:"Select an option",width:"100%"}),$(".number").on("keypress keyup blur",function(e){$(this).val($(this).val().replace(/[^\d].+/,"")),(e.which<48||e.which>57)&&e.preventDefault()}),Toast=Swal.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:4e3}),$(".datepicker").datetimepicker({format:"DD/MM/YYYY"}),$(".timepicker").datetimepicker({format:"H:mm:ss"})}),$(document).ready(function(e){const t=$(".form");if(t.length>0){const e=t.prop("classList");if(!arrContains("form_page",e)){let a=t.find("input.id:hidden");ID=a.val();const o=t.find("input, textarea, select");let n=SITE_URL+SHOW+ID;setSave="update",$.ajax({url:n,type:"GET",async:!1,cache:!1,dataType:"JSON",beforeSend:function(){$(".save_form").attr("disabled",!0),loadingForm(t.find("form").attr("id"),"facebook")},complete:function(){$(".save_form").removeAttr("disabled"),hideLoadingForm(t.find("form").attr("id"))},success:function(a){cardTitle.html(capitalize(LAST_URL));for(let n=0;n<a.length;n++){let i=a[n].field,r=a[n].label;for(let t=0;t<e.length;t++)"show"===e[t].toLowerCase()&&"title"===i?modalTitle.html(capitalize(r)):"title"===i&&cardTitle.html(capitalize(r));for(let e=0;e<o.length;e++)o[e].name===i&&(t.find("input:text[name="+o[e].name+"], textarea[name="+o[e].name+"]").val(r),t.find("select[name="+o[e].name+"]").val(r).change())}}})}}});